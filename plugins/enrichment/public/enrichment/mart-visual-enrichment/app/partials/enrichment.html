<div class="container">

        <div class="enrichment container" ng-controller="EnrichmentCtrl as enr">
            <h1 class="mve-title">Enrichment</h1>
            <div class="button-container" ng-controller="QueryCtrl as ctrl">
                <button class="btn btn-default" ng-click="ctrl.clear()">Clear</button>
                <button class="btn btn-default" ng-click="ctrl.showQuery()">Get XML Query</button>
                <button class="btn btn-danger" ng-click="ctrl.submit()">Submit</button>
            </div>
            <div class="mve-species row" ng-controller="SpeciesCtrl">
                <div class="col-md-6">
                    <select class="form-control"
                        ng-model="selectedSpecies"
                        ng-options="s.displayName for s in species"
                        ng-change="updateSpecies(selectedSpecies)">
                    </select>
                </div>
            </div>
            <!-- sets -->
            <div class="row mve-sets">
                <div class="col-md-6">
                    <tabset>
                        <tab active="enr.geneTabActive"
                             select="enr.selectTab(1)">
                            <tab-heading>
                                <h3>Gene List</h3>
                            </tab-heading>
                            <div class="mve-sets-form" mv-filter="{{enr.getFilter('sets')}}">
                            </div>
                        </tab>
                        <tab active="enr.bedTabActive" 
                             select="enr.selectTab(2)">
                            <tab-heading>
                                <h3>BED File</h3>
                            </tab-heading>
                            <div class="mve-bed-form col-md-6"
                                 mv-filter="{{enr.getFilter('bed_regions')}}">
                             </div>
                             <div class="col-md-4">
                                <div class="mve-upstream" mv-filter="{{enr.getFilter('upstream')}}">
                                 </div>
                                <div class="mve-downstream" mv-filter="{{enr.getFilter('downstream')}}">
                                 </div>
                             </div>
                        </tab>
                    </tabset>
                </div>
            </div>

            <!-- background -->
            <div class="row mve-background">
                <div class="col-md-6">
                    <hr/>
                    <tabset type="pills" justified="true">
                        <tab>
                            <tab-heading>
                                <h3 ng-click="enr.onClickBackground()">
                                    <span class="collapse-symbol">
                                        {{enr.backgroundIsCollapsed ? "+" : "–"}}
                                    </span>
                                    Background
                                </h3>
                            </tab-heading>
                            <div collapse="enr.backgroundIsCollapsed" mv-filter="{{enr.getFilter('background')}}">
                             </div>
                        </tab>
                    </tabset>
                </div>
            </div>

            <!-- cutoff and the rest -->
            <div class="row mve-filters">
                <div class="col-md-6">
                    <hr/>
                    <tabset type="pills" justified="true">
                        <tab>
                            <tab-heading>
                                <h3 ng-click="enr.onClickCutoff()">
                                    <span class="collapse-symbol">
                                        {{enr.cutoffIsCollapsed ? "+" : "–"}}
                                    </span>
                                    Filters
                                </h3>
                            </tab-heading>
                            <div collapse="enr.cutoffIsCollapsed">
                                <div class="mve-cutoff" mv-filter="{{enr.getFilter('cutoff')}}"></div>
                                <div class="mve-bonferroni" mv-filter="{{enr.getFilter('bonferroni')}}"></div>
                                <div mv-filter="{{enr.getFilter('gene_type')}}"></div>
                                <div mv-filter="{{enr.getFilter('gene_limit')}}"></div>
                                <div mv-filter="{{enr.getFilter('homolog')}}"></div>
                            </div>
                        </tab>
                    </tabset>
                </div>
            </div>

            <!-- annotations -->
            <div class="row mve-annotations">
                <div class="col-md-6">
                    <hr/>
                    <tabset type="pills" justified="true">
                        <tab>
                            <tab-heading>
                                <h3 ng-click="enr.onClickAnnotation()">
                                    <span class="collapse-symbol">
                                        {{enr.annotationIsCollapsed ? "+" : "–"}}
                                    </span>
                                    Annotations
                                </h3>
                            </tab-heading>
                            <div class="mve-annotations" collapse="enr.annotationIsCollapsed">
                                <div ng-repeat="a in enr.getAttributes('annotation')"
                                     mv-attribute="a"></div>
                            </div>
                        </tab>
                    </tabset>
                </div>
            </div>
            <div class="button-container" ng-controller="QueryCtrl as ctrl">
                <button class="btn btn-default" ng-click="ctrl.clear()">Clear</button>
                <button class="btn btn-default" ng-click="ctrl.showQuery()">Get XML Query</button>
                <button class="btn btn-danger" ng-click="ctrl.submit()">Submit</button>
            </div>
        </div>
</div>



<script type="text/javascript">
	var check_load_example = function(){
		if($('#load_example').length>0){
			$('#load_example').click(function(){		
				$(this).parent().find('textarea').val('AURKA, AURKB, AURKC, PLK1, CDK1, CDK4');
				$(this).parent().find('textarea').text('AURKA, AURKB, AURKC, PLK1, CDK1, CDK4');
				$(this).parent().find('textarea').change();		
			});
		}
		else {
			setTimeout(check_load_example,200);
		}
	}

	$(document).ready(function(){
		check_load_example();
	});
</script>


